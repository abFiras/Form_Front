<div class="config-dialog">
  <h2 mat-dialog-title>Configuration Liste Externe</h2>

  <mat-dialog-content class="dialog-content">
    <form [formGroup]="configForm" class="config-form">

      <!-- Label du champ -->
      <mat-form-field appearance="outline" style="  margin-top: 10px;" class="full-width">
        <mat-label>Label du champ</mat-label>
        <input matInput formControlName="label" placeholder="Entrez le libellé du champ">
        <mat-hint>Libellé affiché à l'utilisateur</mat-hint>
        <mat-error *ngIf="configForm.get('label')?.hasError('required')">
          Le label est obligatoire
        </mat-error>
      </mat-form-field>

      <!-- Sélection de la liste externe -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Liste externe</mat-label>
        <mat-select formControlName="externalListId">
          <mat-option value="">-- Sélectionnez une liste --</mat-option>
          <mat-option *ngFor="let list of availableLists" [value]="list.id?.toString()">
            {{ list.name }}
            <span class="list-info">{{ list.itemCount || 0 }} éléments</span>
          </mat-option>
        </mat-select>
        <mat-hint *ngIf="!getSelectedListInfo()">Choisissez une liste de données externes</mat-hint>
        <div *ngIf="getSelectedListInfo()" class="selected-list-info">
          {{ getSelectedListInfo() }}
        </div>
        <mat-error *ngIf="configForm.get('externalListId')?.hasError('required')">
          Sélectionnez une liste externe
        </mat-error>
      </mat-form-field>

      <!-- Mode d'affichage -->
  <!-- Mode d'affichage -->
<mat-form-field appearance="outline" class="full-width">
  <mat-label>Mode d'affichage</mat-label>
  <mat-select formControlName="displayMode" [value]="'radio'" required>
    <mat-option *ngFor="let mode of displayModes" [value]="mode.value">
      {{ mode.label }}
    </mat-option>
  </mat-select>
  <mat-hint>Comment les options seront présentées à l'utilisateur</mat-hint>
  <mat-error *ngIf="configForm.get('displayMode')?.hasError('required')">
    Le mode d'affichage est obligatoire
  </mat-error>
</mat-form-field>

      <!-- Champ obligatoire -->
      <div class="checkbox-field">
        <mat-checkbox formControlName="required">
          Champ obligatoire
        </mat-checkbox>
      </div>

      <!-- Aperçu du mode sélectionné -->
      <div class="preview-section" *ngIf="configForm.get('displayMode')?.value">
        <h4>Aperçu du mode d'affichage</h4>
        <div class="preview-container">



          <!-- Preview Radio -->
<div *ngIf="configForm.get('displayMode')!.value === 'radio'" class="preview-radio">
            <h5>{{ configForm.get('label')?.value || 'Libellé du champ' }}</h5>
            <mat-radio-group disabled>
              <mat-radio-button value="1">Option exemple 1</mat-radio-button>
              <mat-radio-button value="2">Option exemple 2</mat-radio-button>
              <mat-radio-button value="3">Option exemple 3</mat-radio-button>
            </mat-radio-group>
          </div>

          <!-- Preview Checkbox -->
<div *ngIf="configForm.get('displayMode')!.value === 'checkbox'" class="preview-checkbox">
            <h5>{{ configForm.get('label')?.value || 'Libellé du champ' }}</h5>
            <div>
              <mat-checkbox disabled>Option exemple 1</mat-checkbox>
            </div>
            <div>
              <mat-checkbox disabled>Option exemple 2</mat-checkbox>
            </div>
            <div>
              <mat-checkbox disabled>Option exemple 3</mat-checkbox>
            </div>
          </div>

        </div>
      </div>
    </form>

    <!-- État de chargement -->
    <div *ngIf="loading" class="loading-container">
      <mat-spinner diameter="30"></mat-spinner>
      <span>Chargement des listes externes...</span>
    </div>
  </mat-dialog-content>

  <mat-dialog-actions align="end" class="dialog-actions">
    <button mat-button (click)="onCancel()">
      Annuler
    </button>
    <button mat-raised-button
            color="primary"
            (click)="onSave()"
            [disabled]="!configForm.valid">
      Enregistrer
    </button>
  </mat-dialog-actions>
</div>
